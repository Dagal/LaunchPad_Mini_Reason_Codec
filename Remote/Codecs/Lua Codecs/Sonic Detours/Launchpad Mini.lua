g_bars_display_index = -1g_current_bar = -1g_delivered_bar = -1function remote_init()	init_items()	init_inputs()	init_outputs()	endfunction init_items()	local items = {			{name = "Button 1-1", input = "button", output="value"},		{name = "Button 1-2", input = "button", output="value"},		{name = "Button 1-3", input = "button", output="value"},		{name = "Button 1-4", input = "button", output="value"},		{name = "Button 1-5", input = "button", output="value"},		{name = "Button 1-6", input = "button", output="value"},		{name = "Button 1-7", input = "button", output="value"},		{name = "Button 1-8", input = "button", output="value"},				{name = "Button 2-1", input = "button", output="value"},		{name = "Button 2-2", input = "button", output="value"},		{name = "Button 2-3", input = "button", output="value"},		{name = "Button 2-4", input = "button", output="value"},		{name = "Button 2-5", input = "button", output="value"},		{name = "Button 2-6", input = "button", output="value"},		{name = "Button 2-7", input = "button", output="value"},		{name = "Button 2-8", input = "button", output="value"},		{name = "Button 3-1", input = "button", output="value"},		{name = "Button 3-2", input = "button", output="value"},		{name = "Button 3-3", input = "button", output="value"},		{name = "Button 3-4", input = "button", output="value"},		{name = "Button 3-5", input = "button", output="value"},		{name = "Button 3-6", input = "button", output="value"},		{name = "Button 3-7", input = "button", output="value"},		{name = "Button 3-8", input = "button", output="value"},				{name = "Button 4-1", input = "button", output="value"},		{name = "Button 4-2", input = "button", output="value"},		{name = "Button 4-3", input = "button", output="value"},		{name = "Button 4-4", input = "button", output="value"},		{name = "Button 4-5", input = "button", output="value"},		{name = "Button 4-6", input = "button", output="value"},		{name = "Button 4-7", input = "button", output="value"},		{name = "Button 4-8", input = "button", output="value"},				{name = "Button 5-1", input = "button", output="value"},		{name = "Button 5-2", input = "button", output="value"},		{name = "Button 5-3", input = "button", output="value"},		{name = "Button 5-4", input = "button", output="value"},		{name = "Button 5-5", input = "button", output="value"},		{name = "Button 5-6", input = "button", output="value"},		{name = "Button 5-7", input = "button", output="value"},		{name = "Button 5-8", input = "button", output="value"},				{name = "Button 6-1", input = "button", output="value"},		{name = "Button 6-2", input = "button", output="value"},		{name = "Button 6-3", input = "button", output="value"},		{name = "Button 6-4", input = "button", output="value"},		{name = "Button 6-5", input = "button", output="value"},		{name = "Button 6-6", input = "button", output="value"},		{name = "Button 6-7", input = "button", output="value"},		{name = "Button 6-8", input = "button", output="value"},				{name = "Button 7-1", input = "button", output="value"},		{name = "Button 7-2", input = "button", output="value"},		{name = "Button 7-3", input = "button", output="value"},		{name = "Button 7-4", input = "button", output="value"},		{name = "Button 7-5", input = "button", output="value"},		{name = "Button 7-6", input = "button", output="value"},		{name = "Button 7-7", input = "button", output="value"},		{name = "Button 7-8", input = "button", output="value"},				{name = "Button 8-1", input = "button", output="value"},		{name = "Button 8-2", input = "button", output="value"},		{name = "Button 8-3", input = "button", output="value"},		{name = "Button 8-4", input = "button", output="value"},		{name = "Button 8-5", input = "button", output="value"},		{name = "Button 8-6", input = "button", output="value"},		{name = "Button 8-7", input = "button", output="value"},		{name = "Button 8-8", input = "button", output="value"},				{name = "Button A", input = "button", output="value"}, 		{name = "Button B", input = "button", output="value"}, 		{name = "Button C", input = "button", output="value"}, 		{name = "Button D", input = "button", output="value"}, 		{name = "Button E", input = "button", output="value"}, 		{name = "Button F", input = "button", output="value"}, 		{name = "Button G", input = "button", output="value"}, 		{name = "Button H", input = "button", output="value"}, 	}		table.insert(items, { name="Bars Display", input="noinput", output="text" })	g_bars_display_index = table.getn(items)		remote.define_items(items)endfunction init_inputs()	local inputs = {		{pattern="<100x>? 00 7F", name="Button 1-1"},		{pattern="<100x>? 01 7F", name="Button 1-2"},		{pattern="<100x>? 02 7F", name="Button 1-3"},		{pattern="<100x>? 03 7F", name="Button 1-4"},		{pattern="<100x>? 04 7F", name="Button 1-5"},		{pattern="<100x>? 05 7F", name="Button 1-6"},		{pattern="<100x>? 06 7F", name="Button 1-7"},		{pattern="<100x>? 07 7F", name="Button 1-8"},				{pattern="<100x>? 10 7F", name="Button 2-1"},		{pattern="<100x>? 11 7F", name="Button 2-2"},		{pattern="<100x>? 12 7F", name="Button 2-3"},		{pattern="<100x>? 13 7F", name="Button 2-4"},		{pattern="<100x>? 14 7F", name="Button 2-5"},		{pattern="<100x>? 15 7F", name="Button 2-6"},		{pattern="<100x>? 16 7F", name="Button 2-7"},		{pattern="<100x>? 17 7F", name="Button 2-8"},		{pattern="<100x>? 20 7F", name="Button 3-1"},		{pattern="<100x>? 21 7F", name="Button 3-2"},		{pattern="<100x>? 22 7F", name="Button 3-3"},		{pattern="<100x>? 23 7F", name="Button 3-4"},		{pattern="<100x>? 24 7F", name="Button 3-5"},		{pattern="<100x>? 25 7F", name="Button 3-6"},		{pattern="<100x>? 26 7F", name="Button 3-7"},		{pattern="<100x>? 27 7F", name="Button 3-8"},		{pattern="<100x>? 30 7F", name="Button 4-1"},		{pattern="<100x>? 31 7F", name="Button 4-2"},		{pattern="<100x>? 32 7F", name="Button 4-3"},		{pattern="<100x>? 33 7F", name="Button 4-4"},		{pattern="<100x>? 34 7F", name="Button 4-5"},		{pattern="<100x>? 35 7F", name="Button 4-6"},		{pattern="<100x>? 36 7F", name="Button 4-7"},		{pattern="<100x>? 37 7F", name="Button 4-8"},		{pattern="<100x>? 40 7F", name="Button 5-1"},		{pattern="<100x>? 41 7F", name="Button 5-2"},		{pattern="<100x>? 42 7F", name="Button 5-3"},		{pattern="<100x>? 43 7F", name="Button 5-4"},		{pattern="<100x>? 44 7F", name="Button 5-5"},		{pattern="<100x>? 45 7F", name="Button 5-6"},		{pattern="<100x>? 46 7F", name="Button 5-7"},		{pattern="<100x>? 47 7F", name="Button 5-8"},		{pattern="<100x>? 50 7F", name="Button 6-1"},		{pattern="<100x>? 51 7F", name="Button 6-2"},		{pattern="<100x>? 52 7F", name="Button 6-3"},		{pattern="<100x>? 53 7F", name="Button 6-4"},		{pattern="<100x>? 54 7F", name="Button 6-5"},		{pattern="<100x>? 55 7F", name="Button 6-6"},		{pattern="<100x>? 56 7F", name="Button 6-7"},		{pattern="<100x>? 57 7F", name="Button 6-8"},		{pattern="<100x>? 60 7F", name="Button 7-1"},		{pattern="<100x>? 61 7F", name="Button 7-2"},		{pattern="<100x>? 62 7F", name="Button 7-3"},		{pattern="<100x>? 63 7F", name="Button 7-4"},		{pattern="<100x>? 64 7F", name="Button 7-5"},		{pattern="<100x>? 65 7F", name="Button 7-6"},		{pattern="<100x>? 66 7F", name="Button 7-7"},		{pattern="<100x>? 67 7F", name="Button 7-8"},		{pattern="<100x>? 70 7F", name="Button 8-1"},		{pattern="<100x>? 71 7F", name="Button 8-2"},		{pattern="<100x>? 72 7F", name="Button 8-3"},		{pattern="<100x>? 73 7F", name="Button 8-4"},		{pattern="<100x>? 74 7F", name="Button 8-5"},		{pattern="<100x>? 75 7F", name="Button 8-6"},		{pattern="<100x>? 76 7F", name="Button 8-7"},		{pattern="<100x>? 77 7F", name="Button 8-8"},		{pattern="<100x>? 08 7F", name="Button A"},		{pattern="<100x>? 18 7F", name="Button B"},		{pattern="<100x>? 28 7F", name="Button C"},		{pattern="<100x>? 38 7F", name="Button D"},		{pattern="<100x>? 48 7F", name="Button E"},		{pattern="<100x>? 58 7F", name="Button F"},		{pattern="<100x>? 68 7F", name="Button G"},		{pattern="<100x>? 78 7F", name="Button H"},	}	remote.define_auto_inputs(inputs)endfunction init_outputs()	local outputs = {		{name = "Button 1-1", pattern = "90 00 xx", x = "enabled*value*15"},		{name = "Button 1-2", pattern = "90 01 xx", x = "enabled*value*15"},		{name = "Button 1-3", pattern = "90 02 xx", x = "enabled*value*15"},		{name = "Button 1-4", pattern = "90 03 xx", x = "enabled*value*15"},		{name = "Button 1-5", pattern = "90 04 xx", x = "enabled*value*15"},		{name = "Button 1-6", pattern = "90 05 xx", x = "enabled*value*15"},		{name = "Button 1-7", pattern = "90 06 xx", x = "enabled*value*15"},		{name = "Button 1-8", pattern = "90 07 xx", x = "enabled*value*15"},				{name = "Button 2-1", pattern = "90 10 xx", x = "enabled*value*60"},		{name = "Button 2-2", pattern = "90 11 xx", x = "enabled*value*60"},		{name = "Button 2-3", pattern = "90 12 xx", x = "enabled*value*60"},		{name = "Button 2-4", pattern = "90 13 xx", x = "enabled*value*60"},		{name = "Button 2-5", pattern = "90 14 xx", x = "enabled*value*60"},		{name = "Button 2-6", pattern = "90 15 xx", x = "enabled*value*60"},		{name = "Button 2-7", pattern = "90 16 xx", x = "enabled*value*60"},		{name = "Button 2-8", pattern = "90 17 xx", x = "enabled*value*60"},		{name = "Button 3-1", pattern = "90 20 xx", x = "enabled*value*15"},		{name = "Button 3-2", pattern = "90 21 xx", x = "enabled*value*15"},		{name = "Button 3-3", pattern = "90 22 xx", x = "enabled*value*15"},		{name = "Button 3-4", pattern = "90 23 xx", x = "enabled*value*15"},		{name = "Button 3-5", pattern = "90 24 xx", x = "enabled*value*15"},		{name = "Button 3-6", pattern = "90 25 xx", x = "enabled*value*15"},		{name = "Button 3-7", pattern = "90 26 xx", x = "enabled*value*15"},		{name = "Button 3-8", pattern = "90 27 xx", x = "enabled*value*15"},		{name = "Button 4-1", pattern = "90 30 xx", x = "enabled*value*60"},		{name = "Button 4-2", pattern = "90 31 xx", x = "enabled*value*60"},		{name = "Button 4-3", pattern = "90 32 xx", x = "enabled*value*60"},		{name = "Button 4-4", pattern = "90 33 xx", x = "enabled*value*60"},		{name = "Button 4-5", pattern = "90 34 xx", x = "enabled*value*60"},		{name = "Button 4-6", pattern = "90 35 xx", x = "enabled*value*60"},		{name = "Button 4-7", pattern = "90 36 xx", x = "enabled*value*60"},		{name = "Button 4-8", pattern = "90 37 xx", x = "enabled*value*60"},		{name = "Button 5-1", pattern = "90 40 xx", x = "enabled*value*15"},		{name = "Button 5-2", pattern = "90 41 xx", x = "enabled*value*15"},		{name = "Button 5-3", pattern = "90 42 xx", x = "enabled*value*15"},		{name = "Button 5-4", pattern = "90 43 xx", x = "enabled*value*15"},		{name = "Button 5-5", pattern = "90 44 xx", x = "enabled*value*15"},		{name = "Button 5-6", pattern = "90 45 xx", x = "enabled*value*15"},		{name = "Button 5-7", pattern = "90 46 xx", x = "enabled*value*15"},		{name = "Button 5-8", pattern = "90 47 xx", x = "enabled*value*15"},		{name = "Button 6-1", pattern = "90 50 xx", x = "enabled*value*60"},		{name = "Button 6-2", pattern = "90 51 xx", x = "enabled*value*60"},		{name = "Button 6-3", pattern = "90 52 xx", x = "enabled*value*60"},		{name = "Button 6-4", pattern = "90 53 xx", x = "enabled*value*60"},		{name = "Button 6-5", pattern = "90 54 xx", x = "enabled*value*60"},		{name = "Button 6-6", pattern = "90 55 xx", x = "enabled*value*60"},		{name = "Button 6-7", pattern = "90 56 xx", x = "enabled*value*60"},		{name = "Button 6-8", pattern = "90 57 xx", x = "enabled*value*60"},		{name = "Button 7-1", pattern = "90 60 xx", x = "enabled*value*15"},		{name = "Button 7-2", pattern = "90 61 xx", x = "enabled*value*15"},		{name = "Button 7-3", pattern = "90 62 xx", x = "enabled*value*15"},		{name = "Button 7-4", pattern = "90 63 xx", x = "enabled*value*15"},		{name = "Button 7-5", pattern = "90 64 xx", x = "enabled*value*15"},		{name = "Button 7-6", pattern = "90 65 xx", x = "enabled*value*15"},		{name = "Button 7-7", pattern = "90 66 xx", x = "enabled*value*15"},		{name = "Button 7-8", pattern = "90 67 xx", x = "enabled*value*15"},		{name = "Button 8-1", pattern = "90 70 xx", x = "enabled*value*60"},		{name = "Button 8-2", pattern = "90 71 xx", x = "enabled*value*60"},		{name = "Button 8-3", pattern = "90 72 xx", x = "enabled*value*60"},		{name = "Button 8-4", pattern = "90 73 xx", x = "enabled*value*60"},		{name = "Button 8-5", pattern = "90 74 xx", x = "enabled*value*60"},		{name = "Button 8-6", pattern = "90 75 xx", x = "enabled*value*60"},		{name = "Button 8-7", pattern = "90 76 xx", x = "enabled*value*60"},		{name = "Button 8-8", pattern = "90 77 xx", x = "enabled*value*60"},				{name = "Button A", pattern = "90 08 xx", x = "enabled*value*63"},		{name = "Button B", pattern = "90 18 xx", x = "enabled*value*63"},		{name = "Button C", pattern = "90 28 xx", x = "enabled*value*63"},		{name = "Button D", pattern = "90 38 xx", x = "enabled*value*63"},		{name = "Button E", pattern = "90 48 xx", x = "enabled*value*63"},		{name = "Button F", pattern = "90 58 xx", x = "enabled*value*63"},		{name = "Button G", pattern = "90 68 xx", x = "enabled*value*63"},		{name = "Button H", pattern = "90 78 xx", x = "enabled*value*63"},	}	remote.define_auto_outputs(outputs)endfunction remote_deliver_midi()	local ret_events={}	if g_delivered_bar ~= g_current_bar then			if g_current_bar < 1 then table.insert(ret_events, remote.make_midi("B0 68 00")) end		if g_current_bar < 2 then table.insert(ret_events, remote.make_midi("B0 69 00")) end		if g_current_bar < 3 then table.insert(ret_events, remote.make_midi("B0 6A 00")) end		if g_current_bar < 4 then table.insert(ret_events, remote.make_midi("B0 6B 00")) end		if g_current_bar < 5 then table.insert(ret_events, remote.make_midi("B0 6C 00")) end		if g_current_bar < 6 then table.insert(ret_events, remote.make_midi("B0 6D 00")) end		if g_current_bar < 7 then table.insert(ret_events, remote.make_midi("B0 6E 00")) end		if g_current_bar < 8 then table.insert(ret_events, remote.make_midi("B0 6F 00")) end				if g_current_bar > 0 then table.insert(ret_events, remote.make_midi("B0 68 63")) end		if g_current_bar > 1 then table.insert(ret_events, remote.make_midi("B0 69 63")) end		if g_current_bar > 2 then table.insert(ret_events, remote.make_midi("B0 6A 63")) end		if g_current_bar > 3 then table.insert(ret_events, remote.make_midi("B0 6B 63")) end		if g_current_bar > 4 then table.insert(ret_events, remote.make_midi("B0 6C 63")) end		if g_current_bar > 5 then table.insert(ret_events, remote.make_midi("B0 6D 63")) end		if g_current_bar > 6 then table.insert(ret_events, remote.make_midi("B0 6E 63")) end		if g_current_bar > 7 then table.insert(ret_events, remote.make_midi("B0 6F 63")) end	end		g_delivered_bar = g_current_bar		return ret_eventsendfunction remote_set_state(changed_items)	for kk,item_index in ipairs(changed_items) do		if item_index == g_bars_display_index then			if remote.is_item_enabled(item_index) then				g_current_bar = get_relative_bar(remote.get_item_text_value(item_index))			else				g_current_bar = -1			end		end	end		return falseendfunction get_relative_bar(s)	local n=tonumber(s)	n = n - math.floor(n/8)*8	return (n == 0) and 8 or nend